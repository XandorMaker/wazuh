# Wazuh Integration with Veeam Backup

## Decoders & Rules

The integration process involves configuring syslog on the Veeam server, enabling syslog listening on the Wazuh server, testing syslog integration, creating decoders and rules, and visualizing events in the Wazuh dashboard. The provided decoders and rules streamline implementation, with opportunities for further customization.

### Basic Steps:

1. **Configure Syslog on Veeam Server.**
2. **Enable Syslog Listening on Wazuh Server.**
3. **Test Syslog Integration.**
4. **Create Decoders and Rules.**
5. **Test Rules.**
6. **Visualize Events in Wazuh Dashboard.**

### Requirements:

- Veeam Backup & Replication Console (VBR).
- Wazuh Server.
- Access to server configurations (SSH).
- Basic knowledge of syslog configuration.
- Understanding of regular expressions (regex) for decoder and rule creation.

### Rules

**Generic Rules XML:**

In the generic rules XML file, you'll find rules that cover all event IDs generated by Veeam. These rules are designed to capture and categorize events broadly, without focusing on specific details within each event. Here's how each rule is structured:

```xml
<rule id="100316" level="3">
  <decoded_as>Veeam MP</decoded_as>
  <description>$(Description)</description>
  <field name="EventID">28700</field>
</rule>
```

- Rule ID: A unique identifier for the rule.
- Level: The severity level assigned to events captured by this rule.
- Decoded as: Indicates the source or type of the event Decoder, in this case, Veeam MP.
- Description: A placeholder for the description of the event.
- Field: Specifies a field within the event data that the rule is targeting. Here, it's filtering events based on the "EventID" field having the value "28700".
- These generic rules provide a baseline for capturing all Veeam events, which can be further customized and extended as needed.

**Field-specific Rules XML:**

In the field-specific rules XML file, you'll find rules that utilize specific fields within Veeam events to provide more detailed and targeted analysis. These rules focus on correlating events based on certain field values. Here's an example:

```xml
<rule id="100025" level="4">
  <decoded_as>Veeam MP</decoded_as>
  <description>$(Description)</description>
  <field name="Object">Backup</field>
  <field name="State">^mounted.|unmounted.</field>
</rule>
```

- Rule ID, Level, Decoded_as, and Description: Similar to the generic rules.
- Field: Specifies the fields within the event data that the rule is targeting for correlation. Here, it's looking at the "Object" field with the value "Backup" and the "State" field with values matching the regular expression pattern "^mounted." or "unmounted."
These field-specific rules offer more granular control over event analysis by focusing on specific attributes within Veeam events. Users can use these rules as templates for creating custom correlations and alerts tailored to their specific environment and requirements.

You will find 2 Rule files in the Github Repo:

- Field_Veeam_Rules.xml: Some Custom Rule Examples with Mitre IDs.
- Generic_Veeam_rules.xml: Full Veeam Event ID List.

## Conclusion:

This integration strengthens backup security by leveraging Veeam's syslog capabilities and Wazuh's comprehensive security monitoring. By following the outlined steps and utilizing the provided decoders and rules, organizations can enhance their defense against cyber threats targeting backup infrastructure. Further customization and refinement of decoders and rules allow for tailored security monitoring based on specific organizational needs. Thank you for exploring this integration and its potential impact on bolstering backup security. Share your feedback and contributions to improve this integration further.

Blog: http://www.mritsurgeon.co.za/2024/03/maximizing-data-security-veeam-wazuh.html 
